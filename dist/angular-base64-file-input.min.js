angular.module("ByGiro.base64FileInput",[]).directive("base64Input",["$window","$parse",function(e){return{restrict:"A",require:"ngModel",link:function(a,t,n,r){function i(a){for(var t="",n=new Uint8Array(a),r=n.byteLength,i=0;r>i;i++)t+=String.fromCharCode(n[i]);return e.btoa(t)}function s(){switch(preview="",this.previewType){case"image":preview="data:image/"+this.type+";base64,"+this.base64;break;case"text":preview=decodeURIComponent(escape(e.atob(this.base64)))}return preview}var o={};a.readerOnload=function(e){var t=i(e.target.result);o.base64=t,a.$apply(function(){r.$setViewValue(angular.copy(o))})};var p=new FileReader;p.onload=a.readerOnload,t.on("change",function(){var e=t[0].files[0];switch(o.type=e.type,o.name=e.name,o.extension="",e.name.lastIndexOf(".")>=0&&(o.extension=e.name.substr(e.name.lastIndexOf(".")+1)),o.size=e.size,o.getPreview=s,p.readAsArrayBuffer(e),o.previewType="",!0){case o.type.indexOf("image/")>=0:o.previewType="image";break;case o.type.indexOf("text/")>=0:o.previewType="text";break;default:o.previewType="extension"}})}}}]);